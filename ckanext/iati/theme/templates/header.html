{% ckan_extends %}

{% block header_wrapper %}
  <a href="#content" class="hide">{{ _('Skip to primary content') }}</a>
  <header id="header">
    <div class="container">
      {% block header_logo %}
        <a class="logo" href="{{ h.url('home') }}">
          <span>{{ _('IATI Registry') }}</span>
        </a>
      {% endblock %}
      {% block header_nav %}
        <nav>
          {% block header_nav_primary %}
            <ul id="primary-nav">
              <li class="transparency">
                <a href="http://www.aidtransparency.net/">{{ _('Aid Transparency') }}</a>
              </li>
              <li class="standard">
                <a href="http://www.iatistandard.org/">{{ _('IATI Standard') }}</a>
              </li>
              <li class="registry">
                <a href="http://iatiregistry.org/">{{ _('IATI Registry / Data') }}</a>
              </li>
              <li class="community">
                <a href="http://support.iatistandard.org/">{{ _('IATI Community') }}</a>
              </li>
            </ul>
          {% endblock %}
          {% block header_nav_account %}
            {% if c.userobj %}
              <ul id="account-nav" class="authed avatar" data-module="me" data-me="{{ c.userobj.id }}">
                {% if c.userobj.sysadmin %}
                  <li>
                    <a href="{{ h.url_for(controller='admin', action='index') }}" title="{{ _('Sysadmin settings') }}">
                      <i class="icon-legal"></i>
                    </a>
                  </li>
                {% endif %}
                <li>
                  <a href="{{ h.url_for(controller='user', action='read', id=c.userobj.name) }}" class="image" title="{{ _('View profile') }}">
                    {{ h.gravatar((c.userobj.email_hash if c and c.userobj else ''), size=22) }}
                    <span class="username">{{ c.userobj.display_name }}</span>
                  </a>
                </li>
                {% set new_activities = c.new_activities %}
                <li class="notifications {% if new_activities > 0 %}notifications-important{% endif %}">
                  {% set notifications_tooltip = ngettext('Dashboard (%(num)d new item)', 'Dashboard (%(num)d new items)', new_activities) %}
                  <a href="{{ h.url_for(controller='user', action='dashboard') }}" title="{{ notifications_tooltip }}">
                    <i class="icon-dashboard"></i>
                    <span>{{ new_activities }}</span>
                  </a>
                </li>
                <li>
                  <a href="{{ h.url_for(controller='user', action='edit', id=c.userobj.name) }}" title="{{ _('Edit settings') }}">
                    <i class="icon-cog"></i>
                  </a>
                </li>
                <li>
                  <a href="{{ h.url_for('/user/_logout') }}" title="{{ _('Log out') }}">
                    <i class="icon-signout"></i>
                  </a>
                </li>
              </ul>
            {% else %}
              <ul id="account-nav" class="not-authed">
                <li>{% link_for _('Log in'), controller='user', action='login' %}</li>
                <li>{% link_for _('Register'), controller='user', action='register', class_='sub' %}</li>
              </ul>
            {% endif %}
          {% endblock %}
          {% block header_nav_secondary %}
            <ul id="secondary-nav">
               {{ h.build_nav_main(
                  ('home', _('Home')),
                  ('search', _('Data')),
                  ('organization_index', _('Publishers')),
                  ('about', _('About'))
                ) }}
            </ul>
          {% endblock %}
        </nav>
      {% endblock %}
  </header>
{% endblock %}
