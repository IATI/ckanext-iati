<html xmlns:py="http://genshi.edgewall.org/"
  xmlns:i18n="http://genshi.edgewall.org/i18n"
  xmlns:xi="http://www.w3.org/2001/XInclude"
  py:strip="">
    <py:def function="page_title">CSV Import Results</py:def>
    <div py:match="content">

        <h2 class="head">CSV Import Results</h2>

        <div>CSV file <strong>${c.file_name}</strong> imported. (<a href="/csv/upload">Upload another file</a>)</div>
        <hr class="cleared" />
        <h3>Summary</h3>
        <ul>
            <li><a href="#added">Datasets created: ${len(c.added)}</a></li>
            <li><a href="#updated">Datasets updated: ${len(c.updated)}</a></li>
            <li><a href="#warnings">Warnings found: ${len(c.warnings)}</a></li>
            <li><a href="#errors">Errors found: ${len(c.errors)}</a></li>
        </ul>
        <h3><a name="added">Datasets added</a></h3>
        <ul>
        <py:for each="pkg in c.added">
            <li><a href="${h.url_for(controller='package', action='read', id=pkg)}">${g.site_url}${h.url_for(controller='package', action='read', id=pkg)}</a></li>
        </py:for>
        <py:if test="not c.added">
            <li><i>None</i></li>
        </py:if>
        </ul>

        <h3><a name="updated">Datasets updated</a></h3>
        <ul>
        <py:for each="pkg in c.updated">
            <li><a href="${h.url_for(controller='package', action='read', id=pkg)}">${g.site_url}${h.url_for(controller='package', action='read', id=pkg)}</a></li>
        </py:for>
        <py:if test="not c.updated">
            <li><i>None</i></li>
        </py:if>

        </ul>

        <h3><a name="warnings">Warnings</a></h3>
        <ul>
        <py:for each="row,fields in c.warnings">
            <li>Line ${row}:
                <ul>
                <py:for each="field,msgs in fields.iteritems()">
                    <li><strong>${field}</strong>: ${msgs}</li>
                </py:for>
                </ul>
            </li>
        </py:for>
        <py:if test="not c.warnings">
            <li><i>None</i></li>
        </py:if>

        </ul>

        <h3><a name="errors">Errors found</a></h3>
        <ul>
        <py:for each="row,fields in c.errors">
            <li>Line ${row}:
                <ul>
                <py:for each="field,msgs in fields.iteritems()">
                    <li><strong>${field}</strong>: ${msgs}</li>
                </py:for>
                </ul>
            </li>
        </py:for>
        <py:if test="not c.errors">
            <li><i>None</i></li>
        </py:if>

        </ul>

        </div>

    <xi:include href="../layout.html" />
</html>
